# Repo - 仓库 

 <p>仓库分为文档／画板两种类型。</p>

 ### 获取某个用户/组织的仓库列表 



 ``` rb 
 # for User
GET /users/:login/repos
# for Group
GET /groups/:login/repos

# 或
GET /users/:id/repos
GET /groups/:id/repos 
 ``` 



 #### Parameters 

<table class="lake-table" style><colgroup><col width="250"><col width="250"><col width="250"></colgroup><tbody><tr><td><p>Name</p></td><td><p>Type</p></td><td><p>Description</p></td></tr><tr><td><p>type</p></td><td><p>string</p></td><td><p><code>Book</code>, <code>Design</code>, <code>all</code> - 所有类型</p></td></tr><tr><td><p>offset</p></td><td><p>integer</p></td><td><p>用于分页，效果类似 MySQL 的 limit offset，一页 20 条</p></td></tr></tbody></table>

 #### Response 

<p>Array<<a href="BookSerializer" target="_blank">BookSerializer</a>></p><p>Example:</p>

 ``` json 
 {
  "data": [
    {
      "id": 100,
      "name": "某某仓库",
      "slug": "notes",
      "namespace": "foo/notes",
      "description": "",
    },
    { ... }
  ]
} 
 ``` 



 ### 创建新仓库 



 ``` rb 
 # 往组织创建仓库
POST /groups/:login/repos
# 往自己下面创建仓库
POST /users/:login/repos
# 或
POST /users/:id/repos
POST /groups/:id/repos 
 ``` 

<blockquote><p>需要 Group 的 <code>abilities.repo.create</code> 权限</p></blockquote>

 #### Parameters 

<table class="lake-table" style><colgroup><col width="250"><col width="250"><col width="250"></colgroup><tbody><tr><td><p>Name</p></td><td><p>Type</p></td><td><p>Description</p></td></tr><tr><td><p>name</p></td><td><p>string</p></td><td><p>仓库名称</p></td></tr><tr><td><p>slug</p></td><td><p>string</p></td><td><p>slug</p></td></tr><tr><td><p>description</p></td><td><p>string</p></td><td><p>说明</p></td></tr><tr><td><p>public</p></td><td><p>integer</p></td><td><p>0 私密, 1 内网公开, 2 全网公开</p></td></tr><tr><td><p>type</p></td><td><p>string</p></td><td><p>‘Book’ 文库, ‘Design’ 画板, 请注意大小写</p></td></tr></tbody></table>

 #### Response 

<p><a href="BookDetailSerializer" target="_blank">BookDetailSerializer</a></p>

 ### 获取仓库详情 



 ``` rb 
 GET /repos/:namespace
# 或
GET /repos/:id 
 ``` 



 #### Parameters 

<table class="lake-table" style><colgroup><col width="375"><col width="375"></colgroup><tbody><tr><td><p>字段</p></td><td><p>说明</p></td></tr><tr><td><p>type</p></td><td><p>仓库类型，Book - 文库，Design - 设计稿</p></td></tr></tbody></table>

 #### Response 

<p><a href="http://yuque.com/yuque/developer/repo/BookDetailSerializer" target="_blank">BookDetailSerializer</a></p>

 ``` json 
 {
  "data": {
    BookDetailSerializer
  },
  "abilities": {
    "update": true,
    "destroy": false
  }
} 
 ``` 



 ### 更新仓库信息 



 ``` rb 
 PUT /repos/:namespace
# 或
PUT /repos/:id 
 ``` 

<blockquote><p>需要 Repo 的 <code>abilities.update</code> 权限</p></blockquote>

 #### Parameters 

<table class="lake-table" style><colgroup><col width="250"><col width="250"><col width="250"></colgroup><tbody><tr><td><p>Name</p></td><td><p>Type</p></td><td><p>Description</p></td></tr><tr><td><p>name</p></td><td><p>string</p></td><td><p>仓库名称</p></td></tr><tr><td><p>slug</p></td><td><p>string</p></td><td><p>slug</p></td></tr><tr><td><p>toc</p></td><td><p>string</p></td><td><p>更新文档仓库的目录信息</p></td></tr><tr><td><p>description</p></td><td><p>string</p></td><td><p>说明</p></td></tr><tr><td><p>public</p></td><td><p>integer</p></td><td><p>0 私密, 1 内网公开, 2 全网公开</p></td></tr></tbody></table>

 #### Response 

<p><a href="http://yuque.com/yuque/developer/repo/BookDetailSerializer" target="_blank">BookDetailSerializer</a></p>

 ### 删除仓库 



 ``` rb 
 DELETE /repos/:namespace
# 或
DELETE /repos/:id 
 ``` 

<blockquote><p>需要 Repo 的 <code>abilities.destroy</code> 权限</p></blockquote>

 ### 获取一个仓库的目录结构 



 ``` rb 
 GET /repos/:namespace/toc
# 或
GET /repos/:id/toc 
 ``` 

<blockquote><p>需要 Repo 的 <code>abilities.read</code> 权限</p></blockquote><p>如果是 Group 成员，将能获取到私密文档、未发布的草稿。</p>

 #### Response 

<table class="lake-table" style><colgroup><col width="375"><col width="375"></colgroup><tbody><tr><td><p>Field</p></td><td><p>Description</p></td></tr><tr><td><p>title</p></td><td><p>标题</p></td></tr><tr><td><p>slug</p></td><td><p>文档 Slug</p></td></tr><tr><td><p>depth</p></td><td><p>目录层次 1 第一层</p></td></tr></tbody></table><p>如原始结构可能是这样：</p>

 ``` markdown 
 - [快速开始](get-stared)
  - [安装](install)
- [功能特色](features) 
 ``` 



 ``` json 
 {
  "data": [
    {
      "title": "快速开始",
      "slug": "get-stared",
      "depth": 1,
    },
	{
      "title": "安装",
      "slug": "install",
      "depth": 2,
    },
	{
	  "title": "功能特色",
      "slug": "features",
      "depth": 1,
	}
  ]
} 
 ``` 



 ### 基于关键字搜索仓库 



 ``` rb 
 GET /search/repos?q=&type= 
 ``` 

<blockquote><p>NOTE: 无法搜索到私密仓库</p></blockquote>

 #### Parameters 

<table class="lake-table" style><colgroup><col width="375"><col width="375"></colgroup><tbody><tr><td><p>Key</p></td><td><p>Description</p></td></tr><tr><td><p>q</p></td><td><p>关键字，目前是简单的数据库模糊查询</p></td></tr><tr><td><p>type</p></td><td><p>类型 (Book, Design），注意大小写，不传搜索所有类型</p></td></tr></tbody></table>

 #### Response 



 ``` json 
 {
  "data": [{
    "id": 127,
    "type": "Book",
    "public": 1,
    "name": "产品需求",
    "slug": "iskYes",
    "user_id": 52,
    "description": "产品需求说明书",
    "created_at": "2016-09-10T22:49:27.000Z",
    "updated_at": "2017-07-26T08:39:28.000Z",
    "user": {
      "id": 52,
      "login": "antcloud",
      "name": "金融云(产品文档)",
      "work_id": null,
      "email": null,
      "avatar_url": "http://larkdoc-assets.oss-cn-hangzhou-zmf.aliyuncs.com/avatar/qdvdfcq9l7yckwcur2mr_antcloud.jpg",
      "created_at": "2016-08-21T23:40:59.000Z",
      "updated_at": "2016-09-10T00:19:12.000Z"
    },
    "namespace": "antcloud/sofa3"
  }, {}, {}]
} 
 ``` 

<br><br><a class="yuque-link" target="_blank" href="https://www.yuque.com/yuque/developer/repo"><svg viewBox="64 64 896 896" class="" data-icon="yuque" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M854.6 370.6c-9.9-39.4 9.9-102.2 73.4-124.4l-67.9-3.6s-25.7-90-143.6-98c-117.8-8.1-194.9-3-195-3 .1 0 87.4 55.6 52.4 154.7-25.6 52.5-65.8 95.6-108.8 144.7-1.3 1.3-2.5 2.6-3.5 3.7C319.4 605 96 860 96 860c245.9 64.4 410.7-6.3 508.2-91.1 20.5-.2 35.9-.3 46.3-.3 135.8 0 250.6-117.6 245.9-248.4-3.2-89.9-31.9-110.2-41.8-149.6zm-204.1 334c-10.6 0-26.2.1-46.8.3l-23.6.2-17.8 15.5c-47.1 41-104.4 71.5-171.4 87.6-52.5 12.6-110 16.2-172.7 9.6 18-20.5 36.5-41.6 55.4-63.1 92-104.6 173.8-197.5 236.9-268.5l1.4-1.4 1.3-1.5c4.1-4.6 20.6-23.3 24.7-28.1 9.7-11.1 17.3-19.9 24.5-28.6 30.7-36.7 52.2-67.8 69-102.2l1.6-3.3 1.2-3.4c13.7-38.8 15.4-76.9 6.2-112.8 22.5.7 46.5 1.9 71.7 3.6 33.3 2.3 55.5 12.9 71.1 29.2 5.8 6 10.2 12.5 13.4 18.7 1 2 1.7 3.6 2.3 5l5 17.7c-15.7 34.5-19.9 73.3-11.4 107.2 3 11.8 6.9 22.4 12.3 34.4 2.1 4.7 9.5 20.1 11 23.3 10.3 22.7 15.4 43 16.7 78.7 3.3 94.6-82.7 181.9-182 181.9z"></path></svg> 使用语雀查看</a>